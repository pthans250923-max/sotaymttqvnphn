<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> - S·ªî TAY MTTQVN - PH∆Ø·ªúNG H·ªíNG NG·ª∞ </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700;800;900&family=Be+Vietnam+Pro:wght@300;400;500;700&display=swap');
        
        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: #f0f4f0; 
            color: #1a2e1a; 
        }
        
        h1, h2, h3, .serif-font {
            font-family: 'Montserrat', sans-serif;
        }

        /* Custom Scrollbar Emerald Style */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #ecf3ec; 
        }
        ::-webkit-scrollbar-thumb {
            background: #059669; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #047857; 
        }

        .book-card {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .book-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px -5px rgba(5, 150, 105, 0.2);
        }

        .func-card {
            transition: all 0.2s;
            border: 1px solid transparent;
        }
        .func-card:hover {
            border-color: #10b981;
            background-color: #f0fdf4;
        }

        /* Login Overlay */
        #loginOverlay {
            transition: opacity 0.5s ease-in-out;
            background-image: linear-gradient(rgba(255, 255, 255, 0.92), rgba(255, 255, 255, 0.92)), url('https://www.transparenttextures.com/patterns/leaf.png');
        }
        
        .toolbar-btn.active {
            background-color: #064e3b;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }

        /* Dropdown Styles */
        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            background-color: white;
            min-width: 280px;
            box-shadow: 0px 10px 25px rgba(0,0,0,0.1);
            z-index: 100;
            border-radius: 0.75rem;
            border: 1px solid #d1fae5;
            overflow: hidden;
        }
        .dropdown:hover > .dropdown-content {
            display: block;
            animation: fadeIn 0.2s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .dropdown-content a, .dropdown-content button {
            color: #374151;
            padding: 12px 20px;
            display: block;
            width: 100%;
            text-align: left;
            transition: all 0.2s;
        }
        .dropdown-content a:hover {
            background-color: #ecfdf5;
            color: #059669;
            padding-left: 25px;
        }

        .border-badge {
            background: linear-gradient(135deg, #059669 0%, #064e3b 100%);
        }

        .ibg-logo {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, #fff 0%, #d1fae5 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: 900;
        }

       .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        /* ƒê·∫£m b·∫£o n·ªôi dung kh√¥ng b·ªã v·ª° tr√™n mobile */
        #mainToolbar {
            -webkit-overflow-scrolling: touch;
        }
        .toolbar-btn.active {
            background-color: #064e3b !important;
            color: white !important;
        }

        #mainToolbar {
            overflow-x: auto;
            overflow-y: visible !important; /* Kh√¥ng c·∫Øt n·ªôi dung theo chi·ªÅu d·ªçc */
            display: flex;
            flex-wrap: nowrap;
        }

        /* ƒê·∫£m b·∫£o dropdown lu√¥n n·ªïi l√™n tr√™n c√πng */
        .group-hover\:block {
            position: absolute !important;
            top: 100%;
            left: 0;
        }
    </style>
</head>
<body class="flex flex-col h-screen overflow-hidden">

    <!-- LOGIN OVERLAY SECTION -->
    <div id="loginOverlay" class="fixed inset-0 z-[9999] flex flex-col items-center justify-center p-4 bg-emerald-900/40 backdrop-blur-md">
    <div class="bg-white p-8 md:p-12 rounded-[2rem] shadow-2xl max-w-lg w-full text-center border border-emerald-100 relative overflow-hidden">
        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-yellow-400 via-red-500 to-emerald-600"></div>
        
        <div class="mb-8 flex justify-center relative">
    <div class="p-2 bg-white rounded-full shadow-sm border border-emerald-50">
        <img src="https://haitrieu.com/wp-content/uploads/2022/01/Logo-Mat-Tran-To-Quoc-Viet-Nam.png" 
             alt="MTTQ Vi·ªát Nam" 
             style="width: 80px; height: 80px; object-fit: contain; display: block; margin: 0 auto; min-width: 80px; min-height: 80px;">
    </div>
</div>

        <h2 class="text-xl font-bold text-emerald-900 mb-2 uppercase tracking-tight">S·ªî TAY: MTTQVN PH∆Ø·ªúNG H·ªíNG NG·ª∞</h2>
        <p class="text-[11px] font-bold text-emerald-700 mb-8 uppercase tracking-wider leading-relaxed opacity-80">
            M·∫∑t tr·∫≠n T·ªï qu·ªëc v√† c√°c T·ªï ch·ª©c Ch√≠nh tr·ªã - X√£ h·ªôi<br>Ph∆∞·ªùng H·ªìng Ng·ª±, t·ªânh ƒê·ªìng Th√°p
        </p>
        
        <div class="relative mb-6 text-left">
            <input type="password" id="passwordInput" placeholder="Nh·∫≠p m·∫≠t kh·∫©u truy c·∫≠p..." 
                class="w-full px-6 py-4 rounded-2xl border-2 border-emerald-50 bg-emerald-50/30 focus:bg-white focus:outline-none focus:ring-4 focus:ring-emerald-500/10 focus:border-emerald-600 transition-all text-lg text-center font-bold tracking-[0.2em]"
                onkeypress="if(event.key === 'Enter') attemptLogin()">
            <span class="absolute right-5 top-5 text-emerald-400">üõ°Ô∏è</span>
        </div>

        <button onclick="attemptLogin()" 
            class="w-full bg-emerald-800 hover:bg-emerald-700 active:scale-95 text-white font-bold py-4 px-6 rounded-2xl transition-all duration-300 shadow-xl shadow-emerald-900/30 uppercase tracking-widest">
            X√ÅC TH·ª∞C TRUY C·∫¨P
        </button>

        <div id="loginError" class="mt-4 p-3 bg-red-50 text-red-700 rounded-xl text-xs font-bold hidden">
            ‚ö†Ô∏è M·∫≠t kh·∫©u kh√¥ng ch√≠nh x√°c. Vui l√≤ng ki·ªÉm tra l·∫°i.
        </div>
    </div>
</div>

    <!-- Header -->
    <header class="border-badge text-white shadow-xl z-10 shrink-0">
    <div class="container mx-auto px-4 py-4 flex flex-col md:flex-row justify-between items-center gap-4">
        <div class="flex items-center space-x-4 w-full md:w-auto">
            <div class="bg-white/20 p-2 rounded-xl backdrop-blur-md flex flex-col items-center">
                <img src="https://haitrieu.com/wp-content/uploads/2022/01/Logo-Mat-Tran-To-Quoc-Viet-Nam.png" 
                     alt="Logo MTTQ Vi·ªát Nam" 
                     class="h-10 w-10 object-contain">
            </div>
            <div>
                    <h1 class="text-lg font-extrabold tracking-tight uppercase flex items-center gap-2">
                        S·ªî TAY MTTQVN - PH∆Ø·ªúNG H·ªíNG NG·ª∞
                    </h1>
                    <p class="text-[10px] text-emerald-100 font-bold tracking-widest uppercase leading-tight">
                        MTTQ & C√ÅC T·ªî CH·ª®C CH√çNH TR·ªä - X√É H·ªòI - PH∆Ø·ªúNG H·ªíNG NG·ª∞, T·ªàNH ƒê·ªíNG TH√ÅP
                    </p>
                </div>
            </div>
            
            <div class="flex items-center gap-3 w-full md:w-auto flex-1 justify-end">
                <div class="relative w-full md:max-w-md">
                    <input type="text" id="searchInput" placeholder="T√¨m vƒÉn b·∫£n, ngh·ªã quy·∫øt, k·ªπ nƒÉng..." 
                        class="w-full pl-5 pr-12 py-2.5 rounded-2xl text-gray-800 focus:outline-none focus:ring-4 focus:ring-white/20 bg-white/10 border border-white/20 placeholder-emerald-100 text-sm backdrop-blur-sm shadow-inner">
                    <span class="absolute right-4 top-2.5 text-white/50">üîç</span>
                </div>
                
                <button onclick="logout()" class="p-2.5 bg-white/10 hover:bg-white/20 text-white rounded-2xl border border-white/10 transition-all" title="ƒêƒÉng xu·∫•t">
                    <span>üö™</span>
                </button>
            </div>
        </div>
    </header>

    <!-- Navigation Bar -->
    <nav class="bg-white border-b border-emerald-100 sticky top-0 z-50 shadow-sm">
        <div class="container mx-auto">
            <!-- Container ch√≠nh v·ªõi c√°c thu·ªôc t√≠nh cu·ªôn ngang -->
            <div id="mainToolbar" class="flex flex-nowrap overflow-x-auto no-scrollbar py-3 px-4 gap-2 items-center" style="scrollbar-width: none; -ms-overflow-style: none;">
                
                <!-- N√∫t Trang ch·ªß -->
                <button onclick="handleToolbarClick('home', this)" class="toolbar-btn active flex-shrink-0 flex items-center gap-2 px-5 py-2.5 rounded-full transition-all whitespace-nowrap text-[13px] font-bold uppercase tracking-tight bg-slate-100 text-emerald-900">
                    üè† TRANG CH·ª¶
                </button>

                <!-- M·ª•c c√≥ danh m·ª•c con (S·ª≠ d·ª•ng flex-shrink-0 ƒë·ªÉ kh√¥ng b·ªã co l·∫°i) -->
                <div class="relative group flex-shrink-0">
        <button class="flex items-center gap-2 px-5 py-2.5 rounded-full hover:bg-emerald-50 text-emerald-900 transition-all whitespace-nowrap text-[13px] font-bold uppercase tracking-tight">
            üìú CH·ª¶ TR∆Ø∆†NG <span class="text-[10px] opacity-50">‚ñº</span>
        </button>
        
        <!-- Dropdown Menu: ƒê·∫£m b·∫£o kh√¥ng b·ªã ·∫©n khi tr∆∞·ª£t ngang -->
        <div class="hidden group-hover:block absolute left-0 mt-1 w-56 bg-white text-gray-800 rounded-xl shadow-2xl py-2 z-[100] border border-emerald-100">
            <a href="#" onclick="setActiveCategory('Ch·ªß tr∆∞∆°ng c·ªßa ƒê·∫£ng')" class="block px-4 py-3 hover:bg-emerald-50 hover:text-emerald-700 text-xs font-bold border-b border-slate-50">üìÅ Ngh·ªã quy·∫øt ƒê·∫£ng</a>
            <a href="#" onclick="setActiveCategory('Ph√°p lu·∫≠t Nh√† n∆∞·ªõc')" class="block px-4 py-3 hover:bg-emerald-50 hover:text-emerald-700 text-xs font-bold">üìÅ VƒÉn b·∫£n ph√°p lu·∫≠t</a>
        </div>
    </div>

                <!-- C√°c n√∫t m·ª•c l·ª•c kh√°c -->
                <button onclick="setActiveCategory('VƒÉn b·∫£n ƒë·ªãa ph∆∞∆°ng', this)" class="toolbar-btn flex-shrink-0 flex items-center gap-2 px-5 py-2.5 rounded-full hover:bg-emerald-50 text-emerald-900 transition-all whitespace-nowrap text-[13px] font-bold uppercase tracking-tight">
                    üìç ƒê·ªäA PH∆Ø∆†NG
                </button>

                <button onclick="handleToolbarClick('chatbot', this)" class="toolbar-btn flex-shrink-0 flex items-center gap-2 px-5 py-2.5 rounded-full hover:bg-emerald-50 text-emerald-900 transition-all whitespace-nowrap text-[13px] font-bold uppercase tracking-tight">
                    ü§ñ CHATBOT AI
                </button>

                <button onclick="handleToolbarClick('quiz', this)" class="toolbar-btn flex-shrink-0 flex items-center gap-2 px-5 py-2.5 rounded-full hover:bg-emerald-50 text-emerald-900 transition-all whitespace-nowrap text-[13px] font-bold uppercase tracking-tight">
                    üéÆ TR·∫ÆC NGHI·ªÜM
                </button>

                <button onclick="handleToolbarClick('contact', this)" class="toolbar-btn flex-shrink-0 flex items-center gap-2 px-5 py-2.5 rounded-full hover:bg-emerald-50 text-emerald-900 transition-all whitespace-nowrap text-[13px] font-bold uppercase tracking-tight">
                    üìû LI√äN H·ªÜ
                </button>

            </div>
        </div>
    </nav>

    <div class="flex flex-1 overflow-hidden">
        <!-- Sidebar -->
        <aside id="sidebarPanel" class="hidden md:flex flex-col w-72 bg-white border-r border-emerald-50 shadow-sm overflow-y-auto shrink-0">
            <div class="p-6">
                <h3 class="font-bold text-emerald-900 uppercase text-[10px] tracking-widest mb-4 opacity-50">C·∫©m nang t√°c nghi·ªáp</h3>
                <nav id="categoryNav" class="space-y-1">
                    <!-- Nav items injected by JS -->
                </nav>
            </div>
            
            <div class="mt-auto p-6 bg-emerald-50/50 m-4 rounded-3xl border border-emerald-100">
                <div class="flex items-center gap-3 mb-3">
                    <div class="p-2 bg-emerald-600 text-white rounded-lg animate-pulse">üì°</div>
                    <div class="text-[11px] font-black text-emerald-900 uppercase tracking-tighter">TR·ª∞C BAN S·ªê MTTQVN</div>
                </div>
                <div class="text-lg font-black text-emerald-900 mb-1">1900.XXXX</div>
                <p class="text-[10px] text-emerald-600 font-medium">H·ªó tr·ª£ th√¥ng tin 24/7 t·∫°i Ph∆∞·ªùng</p>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col overflow-y-auto bg-[#f8faf8] relative scroll-smooth w-full" id="mainContent">
            
            <!-- Mobile Filter -->
            <div id="mobileFilterPanel" class="md:hidden p-4 bg-white border-b border-emerald-50 sticky top-0 z-20 shrink-0 shadow-sm">
                <select id="mobileCatSelect" class="block w-full px-4 py-3 text-sm border-emerald-100 focus:ring-emerald-500 focus:border-emerald-500 rounded-xl border bg-emerald-50/30 font-medium">
                    <option value="all">T·∫•t c·∫£ m·ª•c l·ª•c</option>
                </select>
            </div>

            <!-- Content Container -->
            <div id="dynamicContent" class="flex-1 flex flex-col">
                <div id="homeView" class="flex flex-col flex-1">
                    
                    <!-- Dashboard Section -->
                    <div id="dashboardSection" class="p-6 md:p-12 bg-white border-b border-emerald-50">
                        <div class="max-w-6xl mx-auto">
                            <div class="flex flex-col md:flex-row items-center gap-10 mb-12">
                                <div class="flex-1 text-center md:text-left">
                                    <div class="inline-block px-3 py-1 bg-emerald-50 text-emerald-700 text-[10px] font-bold rounded-full border border-emerald-100 mb-4 uppercase tracking-widest">ƒê·∫•t Sen H·ªìng - Ph∆∞·ªùng H·ªìng Ng·ª±</div>
                                    <h2 class="text-3xl font-black text-emerald-900 mb-4 leading-tight">Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi <br><span class="text-emerald-600">S·ªï tay M·∫∑t tr·∫≠n T·ªï qu·ªëc Vi·ªát Nam - ph∆∞·ªùng H·ªìng Ng·ª± !</span></h2>
                                    <p class="text-gray-500 leading-relaxed text-sm">Cung c·∫•p ki·∫øn th·ª©c, ph√°p lu·∫≠t v√† th√¥ng tin h·ªó tr·ª£ t·ª´ M·∫∑t tr·∫≠n T·ªï qu·ªëc Ph∆∞·ªùng H·ªìng Ng·ª± d√†nh cho nh√¢n d√¢n khu v·ª±c bi√™n gi·ªõi.</p>
                                </div>
                                <div class="w-full md:w-64 h-56 bg-emerald-50 rounded-3xl border-2 border-dashed border-emerald-200 flex items-center justify-center relative overflow-hidden group shadow-inner">
                                    <div class="text-center z-10 transition-transform group-hover:scale-110">
                                        <div class="text-5xl mb-3">üå∏</div>
                                        <div class="text-[10px] font-black text-emerald-800 uppercase tracking-tighter">Ph∆∞·ªùng H·ªìng Ng·ª±</div>
                                        <div class="text-xs font-black text-emerald-600">S·ªï tay MTTQVN</div>
                                    </div>
                                    <div class="absolute -bottom-10 -right-10 w-32 h-32 bg-emerald-100/50 rounded-full"></div>
                                </div>
                            </div>
                            
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                                <div class="func-card p-5 rounded-2xl bg-white shadow-sm cursor-pointer" onclick="setActiveCategory('Ch·ªß tr∆∞∆°ng c·ªßa ƒê·∫£ng')">
                                    <div class="w-12 h-12 bg-emerald-100 rounded-xl flex items-center justify-center text-2xl mb-4">üìï</div>
                                    <h4 class="font-bold text-emerald-900 text-[11px] mb-1 uppercase">ƒê∆∞·ªùng l·ªëi ƒê·∫£ng</h4>
                                    <p class="text-[10px] text-gray-400">Ngh·ªã quy·∫øt m·ªõi v√πng bi√™n.</p>
                                </div>
                                
                                <div class="func-card p-5 rounded-2xl bg-white shadow-sm cursor-pointer" onclick="setActiveCategory('Ph√°p lu·∫≠t Nh√† n∆∞·ªõc')">
                                    <div class="w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center text-2xl mb-4">‚öñÔ∏è</div>
                                    <h4 class="font-bold text-emerald-900 text-[11px] mb-1 uppercase">Lu·∫≠t Bi√™n gi·ªõi</h4>
                                    <p class="text-[10px] text-gray-400">Quy ƒë·ªãnh c∆∞ tr√∫ & Bi√™n ph√≤ng.</p>
                                </div>

                                <div class="func-card p-5 rounded-2xl bg-white shadow-sm cursor-pointer" onclick="setActiveCategory('VƒÉn b·∫£n ƒë·ªãa ph∆∞∆°ng')">
                                    <div class="w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center text-2xl mb-4">üìç</div>
                                    <h4 class="font-bold text-emerald-900 text-[11px] mb-1 uppercase">T·ªânh - Ph∆∞·ªùng</h4>
                                    <p class="text-[10px] text-gray-400">VƒÉn b·∫£n ch·ªâ ƒë·∫°o ƒë·ªãa ph∆∞∆°ng.</p>
                                </div>

                                <div class="func-card p-5 rounded-2xl bg-white shadow-sm cursor-pointer" onclick="setActiveCategory('Ph√°t tri·ªÉn kinh t·∫ø')">
                                    <div class="w-12 h-12 bg-amber-100 rounded-xl flex items-center justify-center text-2xl mb-4">üåæ</div>
                                    <h4 class="font-bold text-emerald-900 text-[11px] mb-1 uppercase">Kinh t·∫ø</h4>
                                    <p class="text-[10px] text-gray-400">VƒÉn b·∫£n ch·ªâ ƒë·∫°o v·ªÅ ph√°t tri·ªÉn kinh t·∫ø.</p>
                                </div>

                            </div>
                        </div>
                    </div>

                    <div class="p-8 md:p-12 flex-1">
                        <div class="max-w-6xl mx-auto w-full">
                            <div class="flex justify-between items-end mb-8">
                                <div>
                                    <h2 id="currentCategoryTitle" class="text-2xl font-bold text-emerald-900 uppercase tracking-tighter">Danh m·ª•c S·ªï tay </h2>
                                    <div class="h-1.5 w-16 bg-emerald-500 mt-2 rounded-full"></div>
                                </div>
                                <p id="resultCount" class="text-[10px] font-black text-emerald-600/50 uppercase tracking-[0.2em]">0 n·ªôi dung t√¨m th·∫•y</p>
                            </div>

                            <div id="bookGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                                <!-- Cards dynamically injected -->
                            </div>
                            
                            <div id="noResults" class="hidden text-center py-24 bg-white rounded-[3rem] border border-emerald-50 shadow-inner">
                                <div class="text-6xl mb-6">üèúÔ∏è</div>
                                <h3 class="text-xl font-black text-emerald-900 uppercase">D·ªØ li·ªáu S·ªï tay MTTQVN ƒëang c·∫≠p nh·∫≠t</h3>
                                <p class="text-gray-400 mt-2 text-sm font-medium">Vui l√≤ng th·ª≠ l·∫°i v·ªõi danh m·ª•c kh√°c.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="quizView" class="hidden flex-1 p-6 bg-emerald-50/30 overflow-y-auto">
    <div class="max-w-4xl mx-auto">
        <div id="quizLibrary">
            <div class="mb-8 text-center">
                <h2 class="text-2xl font-black text-emerald-900 uppercase">Th∆∞ vi·ªán b√†i thi tr·∫Øc nghi·ªám</h2>
                <p class="text-gray-500 text-sm">Ch·ªçn m·ªôt chuy√™n ƒë·ªÅ b√™n d∆∞·ªõi ƒë·ªÉ b·∫Øt ƒë·∫ßu ki·ªÉm tra ki·∫øn th·ª©c</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div onclick="loadQuiz('NGHI_QUYET_33')" class="bg-white p-6 rounded-3xl shadow-sm border border-emerald-100 hover:shadow-md transition-all cursor-pointer group">
                    <div class="w-12 h-12 bg-emerald-100 rounded-2xl flex items-center justify-center text-2xl mb-4 group-hover:bg-emerald-600 group-hover:text-white transition-colors">üìÑ</div>
                    <h4 class="font-bold text-emerald-900 mb-1">Ngh·ªã quy·∫øt s·ªë 33-NQ/TW</h4>
                    <p class="text-[10px] text-gray-400 uppercase font-bold mb-4">10 C√¢u h·ªèi ‚Ä¢ Google Sheets Data</p>
                    <span class="text-xs font-bold text-emerald-600">B·∫ÆT ƒê·∫¶U THI ‚ûú</span>
                </div>
                </div>
        </div>

        <div id="quizArena" class="hidden bg-white rounded-[2.5rem] shadow-2xl overflow-hidden border border-emerald-100">
            <div class="p-6 bg-emerald-900 text-white flex justify-between items-center">
                <div id="currentQuizTitle" class="font-bold uppercase text-sm">ƒêang thi...</div>
                <div class="bg-white/20 px-4 py-1 rounded-full text-xs font-mono" id="quizTimer">10:00</div>
            </div>
            <div id="questionBox" class="p-8">
                </div>
        </div>
    </div>
</div>

        
            
                <!-- Placeholder View -->
                <div id="placeholderView" class="hidden p-20 flex-1 flex flex-col items-center justify-center text-center bg-white">
                    <div class="text-8xl mb-8 opacity-20">üì°</div>
                    <h2 class="text-3xl font-black text-emerald-900 mb-4 uppercase tracking-tighter">H·ªá th·ªëng S·ªï tay MTTQVN ƒëang ƒë·ªìng b·ªô</h2>
                    <p class="text-gray-400 max-w-md mx-auto font-medium">H·ªá th·ªëng ƒëang ƒë·ªìng b·ªô d·ªØ li·ªáu v·ªõi C·ªïng th√¥ng tin M·∫∑t tr·∫≠n T·ªï qu·ªëc Ph∆∞·ªùng H·ªìng Ng·ª±. Vui l√≤ng quay l·∫°i sau.</p>
                    <button onclick="handleToolbarClick('home')" class="mt-10 px-10 py-4 bg-emerald-900 text-white rounded-2xl font-black shadow-xl hover:scale-105 transition-transform uppercase tracking-widest text-xs">Quay l·∫°i Trang ch·ªß</button>
                </div>
            </div>
            
            <!-- Footer -->
            <footer class="bg-white border-t border-emerald-50 py-16 px-4 text-center shrink-0">
                <div class="container mx-auto">
                    <p class="font-black text-emerald-900 text-2xl mb-1 tracking-tighter uppercase">S·ªï tay MTTQVN - C√îNG D√ÇN BI√äN GI·ªöI S·ªê</p>
                    <p class="text-emerald-600/60 text-[10px] font-bold uppercase tracking-[0.4em] mb-10">Ph∆∞·ªùng H·ªìng Ng·ª±, t·ªânh ƒê·ªìng Th√°p</p>
                    
                    <div class="flex flex-col md:flex-row items-center justify-center gap-6 mb-12">
                        <div class="flex flex-col items-center">
                            <span class="text-[10px] text-gray-400 font-bold uppercase mb-2">Th√¥ng tin li√™n h·ªá S·ªï tay MTTQVN</span>
                            <div class="flex gap-3">
                                <div class="bg-emerald-50 px-5 py-2.5 rounded-2xl border border-emerald-100 text-[11px] font-bold text-emerald-900">üìû 0337.848.108</div>
                                <div class="bg-emerald-50 px-5 py-2.5 rounded-2xl border border-emerald-100 text-[11px] font-bold text-emerald-900">üìß mttq.hongngu@dongthap.vn</div>
                            </div>
                        </div>
                    </div>

                    <!-- Visitor Counter -->
                    <div class="flex flex-col items-center">
                        <div class="flex items-center gap-4 bg-emerald-950 text-white px-8 py-3 rounded-full shadow-2xl border border-emerald-800">
                            <div class="flex items-center gap-2">
                                <span class="relative flex h-2.5 w-2.5">
                                  <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                                  <span class="relative inline-flex rounded-full h-2.5 w-2.5 bg-emerald-400"></span>
                                </span>
                                <span class="text-[9px] font-black uppercase tracking-widest text-emerald-300">T·ªïng l∆∞·ª£t truy c·∫≠p S·ªï tay MTTQVN:</span>
                            </div>
                            <span id="visitorCount" class="font-mono font-bold text-xl tabular-nums">0</span>
                        </div>
                    </div>
                </div>
            </footer>
        </main>
    </div>

    <!-- JavaScript Section -->
    <script>
    // 1. C·∫§U H√åNH
const SHEET_ID = '1KSurgymEodbAYu70AHgNtxziVgbEeNSCqbJW_fyh4ag';
const APP_PASSWORD = "123456";
const STORAGE_KEY = 'biengioiso_v2_counter';
const BASE_COUNT = 5302;

let libraryData = [];
let currentQuizQuestions = [];
let currentQuestionIndex = 0;
let score = 0;

const state = {
    currentCategory: "all",
    searchQuery: "",
    categories: [],
    books: [],
    currentView: "home"
};

// 2. KH·ªûI T·∫†O
document.addEventListener('DOMContentLoaded', () => {
    initVisitorCount();
    setupEventListeners();
    loadDataFromSheet();
    generateQuizMenu();
    
    if (sessionStorage.getItem('biengioiso_auth') === 'true') {
        const overlay = document.getElementById('loginOverlay');
        if (overlay) overlay.style.display = 'none';
    }
});

function initVisitorCount() {
    let count = localStorage.getItem(STORAGE_KEY) || BASE_COUNT;
    const el = document.getElementById('visitorCount');
    if (el) el.innerText = parseInt(count).toLocaleString('vi-VN');
}

window.attemptLogin = function() {
    const passInput = document.getElementById('passwordInput');
    const overlay = document.getElementById('loginOverlay');
    if (passInput && passInput.value === APP_PASSWORD) {
        sessionStorage.setItem('biengioiso_auth', 'true');
        if (overlay) {
            overlay.classList.add('opacity-0', 'pointer-events-none');
            setTimeout(() => { overlay.style.display = 'none'; }, 500);
        }
    } else {
        const errorMsg = document.getElementById('loginError');
        if (errorMsg) errorMsg.classList.remove('hidden');
    }
};

// 3. T·∫¢I T√ÄI LI·ªÜU (TAB TAILIEU)
async function loadDataFromSheet() {
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=Tailieu`;
    try {
        const res = await fetch(url);
        const data = await res.text();
        if (data.includes("<!DOCTYPE")) return;

        const rows = data.split(/\r?\n/).filter(line => line.trim() !== "").slice(1);
        libraryData = rows.map(row => {
            const c = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(s => s.replace(/^"|"$/g, '').trim());
            if (c.length >= 4 && c[2]) {
                return { id: c[0], category: c[1], title: c[2], link: c[3] };
            }
            return null;
        }).filter(i => i);
        
        state.books = libraryData;
        state.categories = Array.from(new Set(libraryData.map(b => b.category)));
        renderNavigation();
        renderBooks();
    } catch (e) { console.error("L·ªói Tailieu:", e); }
}

// 4. HI·ªÇN TH·ªä MENU ƒê·ªÄ THI (TAB MENUQUIZ)
async function generateQuizMenu() {
    const menuBox = document.getElementById('quizLibrary');
    if (!menuBox) return;
    
    menuBox.innerHTML = '<div class="text-center p-10 text-emerald-900 font-bold animate-pulse text-xs uppercase">ƒêang t·∫£i danh s√°ch ƒë·ªÅ...</div>';

    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=MenuQuiz`;
    try {
        const res = await fetch(url);
        const data = await res.text();
        
        if (data.includes("<!DOCTYPE")) {
            menuBox.innerHTML = '<div class="p-6 text-red-600 text-xs font-bold text-center uppercase">Vui l√≤ng ch·ªçn ƒë·ªãnh d·∫°ng "Web Page" trong ph·∫ßn Publish to the web c·ªßa Google Sheets!</div>';
            return;
        }

        const rows = data.split(/\r?\n/).filter(line => line.trim() !== "");
        let html = '';
        let found = false;

        rows.forEach((row, index) => {
            const c = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(s => s.replace(/^"|"$/g, '').trim());
            if (c[0] && c[1] && index >= 0 && !c[0].includes("T√™n")) {
                found = true;
                html += `
                <button onclick="startQuiz('${c[1].trim()}', '${c[0].trim()}')" class="w-full text-left p-5 mb-4 bg-white border-2 border-emerald-50 rounded-2xl hover:border-orange-400 hover:shadow-xl transition-all flex items-center gap-4 group shadow-sm active:scale-95">
                    <div class="w-12 h-12 bg-emerald-50 text-emerald-600 rounded-2xl flex items-center justify-center text-xl group-hover:bg-orange-600 group-hover:text-white transition-all">üìù</div>
                    <div class="flex-1">
                        <div class="font-black text-emerald-900 text-sm mb-1 uppercase">${c[0]}</div>
                        <div class="text-[10px] text-gray-400 font-bold uppercase italic">B·∫•m ƒë·ªÉ b·∫Øt ƒë·∫ßu thi ‚ûú</div>
                    </div>
                </button>`;
            }
        });

        menuBox.innerHTML = found ? html : '<div class="text-center p-10 text-gray-400 font-bold text-xs">CH∆ØA C√ì D·ªÆ LI·ªÜU ƒê·ªÄ THI</div>';
    } catch (e) { 
        menuBox.innerHTML = `<div class="p-4 text-red-600 text-xs text-center uppercase">L·ªói k·∫øt n·ªëi: ${e.message}</div>`;
    }
}

// 5. B·∫ÆT ƒê·∫¶U THI
window.startQuiz = async function(tabName, displayName) {
    const quizLib = document.getElementById('quizLibrary');
    const quizArena = document.getElementById('quizArena');
    
    quizLib.classList.add('hidden');
    quizArena.classList.remove('hidden');
    quizArena.innerHTML = `<div class="text-center py-20 text-emerald-900 font-bold animate-pulse text-xs uppercase">ƒêang ƒë·ªìng b·ªô c√¢u h·ªèi t·ª´ tab '${tabName}'...</div>`;
    
    const url = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:csv&sheet=${encodeURIComponent(tabName)}`;
    
    try {
        const res = await fetch(url);
        const data = await res.text();
        const rows = data.split(/\r?\n/).filter(line => line.trim() !== "").slice(1);
        
        currentQuizQuestions = rows.map(row => {
            const c = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(s => s.replace(/^"|"$/g, '').trim());
            if (c.length >= 6) {
                let correctIndex = parseInt(c[5]); 
                return { 
                    q: c[0], 
                    options: [c[1], c[2], c[3], c[4]], 
                    correct: isNaN(correctIndex) ? 0 : correctIndex, 
                    explain: c[6] || ""
                };
            }
            return null;
        }).filter(i => i);
        
        if (currentQuizQuestions.length === 0) throw new Error("Tab tr·ªëng ho·∫∑c sai c·∫•u tr√∫c");

        currentQuestionIndex = 0;
        score = 0;
        renderQuizQuestion(displayName);
    } catch (e) { 
        quizArena.innerHTML = `
            <div class="p-10 text-center bg-white rounded-3xl shadow-xl">
                <p class="text-red-500 font-bold text-xs mb-4 uppercase">L·ªñI: KH√îNG T√åM TH·∫§Y D·ªÆ LI·ªÜU T·∫†I TAB "${tabName}"</p>
                <button onclick="handleToolbarClick('quiz')" class="bg-emerald-900 text-white px-8 py-3 rounded-xl text-xs font-black uppercase">QUAY L·∫†I</button>
            </div>`;
    }
}

function renderQuizQuestion(displayName) {
    const q = currentQuizQuestions[currentQuestionIndex];
    const arena = document.getElementById('quizArena');
    arena.innerHTML = `
        <div class="bg-white rounded-[2rem] p-6 shadow-2xl border border-emerald-50 max-w-2xl mx-auto mb-20">
            <div class="flex justify-between items-center mb-6">
                <span class="text-[10px] bg-emerald-900 text-white px-3 py-1 rounded-full font-black uppercase">${displayName}</span>
                <span class="text-xs font-bold text-gray-300 uppercase">C√¢u ${currentQuestionIndex + 1}/${currentQuizQuestions.length}</span>
            </div>
            <h3 class="text-base font-black text-emerald-900 mb-6 leading-tight">${q.q}</h3>
            <div class="grid gap-3">
                ${q.options.map((opt, i) => opt ? `
                    <button onclick="checkAnswer(${i}, this)" class="quiz-opt-btn text-left p-4 rounded-xl border-2 border-emerald-50 hover:border-orange-400 hover:bg-orange-50 transition-all text-sm font-bold flex items-start gap-3 group active:scale-95">
                        <span class="w-8 h-8 rounded-lg bg-emerald-50 text-emerald-700 flex-shrink-0 flex items-center justify-center text-xs font-black group-hover:bg-orange-600 group-hover:text-white">${String.fromCharCode(65 + i)}</span>
                        <div class="pt-1">${opt}</div>
                    </button>
                ` : '').join('')}
            </div>
            <div id="quizFeedback" class="hidden mt-6 p-5 rounded-2xl bg-orange-50 border-2 border-orange-100">
                <p id="feedbackText" class="font-black text-xs mb-2 uppercase"></p>
                <div class="bg-white/60 p-3 rounded-xl text-xs text-gray-600 leading-relaxed mb-4 italic">${q.explain || 'ƒê√°p √°n ƒë√£ ƒë∆∞·ª£c h·ªá th·ªëng ghi nh·∫≠n.'}</div>
                <button onclick="nextQuizQuestion('${displayName}')" class="w-full py-4 bg-emerald-900 text-white rounded-xl font-black uppercase text-xs tracking-widest shadow-lg active:scale-95">Ti·∫øp theo ‚ûú</button>
            </div>
        </div>
    `;
}

window.checkAnswer = function(choice, el) {
    const q = currentQuizQuestions[currentQuestionIndex];
    const feedback = document.getElementById('quizFeedback');
    const feedbackText = document.getElementById('feedbackText');
    const btns = document.querySelectorAll('.quiz-opt-btn');
    
    btns.forEach(b => {
        b.onclick = null;
        b.style.pointerEvents = 'none';
    });
    feedback.classList.remove('hidden');
    
    if (choice === q.correct) {
        el.classList.add('bg-emerald-600', 'text-white', 'border-emerald-600');
        feedbackText.innerHTML = '‚ú® R·∫•t ch√≠nh x√°c!';
        score++;
    } else {
        el.classList.add('bg-red-500', 'text-white', 'border-red-500');
        if (btns[q.correct]) btns[q.correct].classList.add('bg-emerald-600', 'text-white', 'border-emerald-600');
        feedbackText.innerHTML = '‚ùå ƒê√°p √°n ƒë√∫ng l√† ' + String.fromCharCode(65 + q.correct);
    }
};

window.nextQuizQuestion = function(displayName) {
    currentQuestionIndex++;
    if (currentQuestionIndex < currentQuizQuestions.length) {
        renderQuizQuestion(displayName);
        window.scrollTo({ top: 0, behavior: 'smooth' });
    } else {
        showFinalScore();
    }
};

function showFinalScore() {
    const arena = document.getElementById('quizArena');
    arena.innerHTML = `
        <div class="text-center py-12 bg-white rounded-[3rem] shadow-2xl max-w-md mx-auto border-4 border-emerald-50 mb-20">
            <div class="text-6xl mb-4">üèÜ</div>
            <h2 class="text-lg font-black text-emerald-900 uppercase">Ho√†n th√†nh!</h2>
            <div class="text-6xl font-black text-orange-600 my-8">${score}/${currentQuizQuestions.length}</div>
            <button onclick="handleToolbarClick('quiz')" class="px-10 py-4 bg-emerald-900 text-white rounded-2xl font-black uppercase text-xs tracking-widest active:scale-95 transition-transform">X√°c nh·∫≠n ‚ûú</button>
        </div>
    `;
}

// 6. ƒêI·ªÄU H∆Ø·ªöNG UI
window.handleToolbarClick = function(view) {
    state.currentView = view;
    if (view === 'chatbot') { 
        window.open("https://chatgpt.com/g/g-68ada4c182dc81918f133b37ed0226fb-mttqvn-va-cac-tcctxh-phuong-hong-ngu-ai", "_blank"); 
        return; 
    }
    
    document.getElementById('homeView').classList.toggle('hidden', view === 'quiz');
    document.getElementById('quizView').classList.toggle('hidden', view !== 'quiz');
    
    if (view === 'quiz') {
        document.getElementById('quizLibrary').classList.remove('hidden');
        document.getElementById('quizArena').classList.add('hidden');
        generateQuizMenu();
    }
    window.scrollTo({ top: 0, behavior: 'smooth' });
};

window.setActiveCategory = function(cat) {
    state.currentCategory = cat;
    renderNavigation();
    filterBooks();
};

function filterBooks() {
    let filtered = libraryData;
    if (state.currentCategory !== "all") filtered = filtered.filter(b => b.category === state.currentCategory);
    if (state.searchQuery) {
        const q = state.searchQuery.toLowerCase();
        filtered = filtered.filter(b => b.title.toLowerCase().includes(q));
    }
    state.books = filtered;
    renderBooks();
}

function renderBooks() {
    const container = document.getElementById('bookGrid');
    if (!container) return;
    container.innerHTML = state.books.map(book => `
        <div class="bg-white p-5 rounded-[2rem] border border-emerald-50 shadow-sm flex flex-col justify-between h-full hover:shadow-lg transition-all group">
            <div>
                <span class="text-[10px] font-black uppercase text-emerald-700 bg-emerald-50 px-3 py-1 rounded-full">${book.category}</span>
                <h3 class="font-black text-emerald-900 text-sm mt-4 mb-5 leading-tight group-hover:text-orange-600 transition-colors">${book.title}</h3>
            </div>
            <a href="${book.link}" target="_blank" class="block text-center py-3 bg-emerald-50 text-emerald-900 rounded-xl text-[10px] font-black uppercase tracking-widest hover:bg-emerald-900 hover:text-white transition-all active:scale-95">Xem ngay ‚ûú</a>
        </div>
    `).join('');
}

function renderNavigation() {
    const nav = document.getElementById('categoryNav');
    if (!nav) return;
    let html = `<button onclick="setActiveCategory('all')" class="w-full text-left px-5 py-4 rounded-2xl text-xs font-black uppercase tracking-widest mb-2 transition-all active:scale-95 ${state.currentCategory === 'all' ? 'bg-emerald-900 text-white shadow-lg' : 'text-emerald-800 hover:bg-emerald-50'}">üìÇ T·∫•t c·∫£ t√†i li·ªáu</button>`;
    state.categories.forEach(cat => {
        html += `<button onclick="setActiveCategory('${cat}')" class="w-full text-left px-5 py-4 rounded-2xl text-xs font-black uppercase tracking-widest mb-2 transition-all active:scale-95 ${state.currentCategory === cat ? 'bg-emerald-900 text-white shadow-lg' : 'text-emerald-800 hover:bg-emerald-50'}">üìÑ ${cat}</button>`;
    });
    nav.innerHTML = html;
}

function setupEventListeners() {
    document.getElementById('searchInput')?.addEventListener('input', (e) => {
        state.searchQuery = e.target.value;
        filterBooks();
    });
}
    </script>

    <div id="chatBubble" 
     onclick="handleToolbarClick('chatbot')" 
     class="fixed bottom-6 right-6 z-50 group cursor-pointer">
    
    <div class="absolute bottom-full right-0 mb-4 w-48 bg-white p-3 rounded-2xl shadow-xl border border-emerald-100 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none">
        <p class="text-[11px] text-emerald-800 font-bold text-center">Ch√†o b√† con! Con l√† AI Ph∆∞·ªùng H·ªìng Ng·ª± ƒë√¢y ·∫°. ü§ñ</p>
        <div class="absolute top-full right-6 w-3 h-3 bg-white border-r border-b border-emerald-100 rotate-45 -mt-[6px]"></div>
    </div>

    <div class="w-16 h-16 bg-emerald-600 rounded-full shadow-2xl flex items-center justify-center text-3xl hover:scale-110 hover:bg-emerald-700 transition-all duration-300 animate-bounce">
        ü§ñ
    </div>
    
    <div class="absolute inset-0 w-16 h-16 bg-emerald-500 rounded-full animate-ping opacity-20"></div>
    </div>
</body>
</html>




